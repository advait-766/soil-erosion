\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant}{\section{smoderp2d.\-src.\-courant.\-Courant Class Reference}
\label{classsmoderp2d_1_1src_1_1courant_1_1Courant}\index{smoderp2d.\-src.\-courant.\-Courant@{smoderp2d.\-src.\-courant.\-Courant}}
}


Contains variables and methods needed for time step size handling.  


\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a629841e2699d232acff8b2285dd1dcd7}{def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a629841e2699d232acff8b2285dd1dcd7}{\-\_\-\-\_\-init\-\_\-\-\_\-}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a629841e2699d232acff8b2285dd1dcd7}

\begin{DoxyCompactList}\small\item\em constructor \end{DoxyCompactList}\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae788349453919f497d8712ac4a8e12ef}{def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae788349453919f497d8712ac4a8e12ef}{set\-\_\-time\-\_\-step}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae788349453919f497d8712ac4a8e12ef}

\begin{DoxyCompactList}\small\item\em Store the original guess time step. \end{DoxyCompactList}\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a9ebe11436dc1c1efa6c2a2f4fd2733f2}{def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a9ebe11436dc1c1efa6c2a2f4fd2733f2}{reset}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a9ebe11436dc1c1efa6c2a2f4fd2733f2}

\begin{DoxyCompactList}\small\item\em Resets the self.\-cour\-\_\-most and self.\-cour\-\_\-speed after each time stop computation is successfully completed. \end{DoxyCompactList}\item 
def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_ab69d95fbe66467f71b0a535be611f05b}{initial\-\_\-time\-\_\-step}
\begin{DoxyCompactList}\small\item\em Guesses the initial time step. \end{DoxyCompactList}\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a80d541950a9e78a273f8145e4ea76f3b}{def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a80d541950a9e78a273f8145e4ea76f3b}{C\-F\-L}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a80d541950a9e78a273f8145e4ea76f3b}

\begin{DoxyCompactList}\small\item\em Checks and store in each computational cell the maximum velocity and maximum \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant}{Courant} coefficient. \end{DoxyCompactList}\item 
def \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a6a20926e1f36e2169eccdc27d92d787d}{courant}
\begin{DoxyCompactList}\small\item\em Returns the adjusted/unchanged time step after a time step computation is completed. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a7f7b7ef10ca7fd66b190379cea4203d3}{{\bfseries maxh}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a7f7b7ef10ca7fd66b190379cea4203d3}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2e4c6d74b15eb45d67ebba896b97eb32}{{\bfseries cour\-\_\-speed}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2e4c6d74b15eb45d67ebba896b97eb32}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a059271cdbd6044635ad290eadff9299b}{\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a059271cdbd6044635ad290eadff9299b}{cour\-\_\-crit}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a059271cdbd6044635ad290eadff9299b}

\begin{DoxyCompactList}\small\item\em citical courant value \end{DoxyCompactList}\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_afa3e7bde711d11925d54a41ecffdc2f3}{{\bfseries cour\-\_\-most}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_afa3e7bde711d11925d54a41ecffdc2f3}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2bfcce1ddcb5060045dbd777c848c9f2}{{\bfseries cour\-\_\-most\-\_\-rill}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2bfcce1ddcb5060045dbd777c848c9f2}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae0eb94299899733aa39b68e166115809}{{\bfseries cour\-\_\-coef}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae0eb94299899733aa39b68e166115809}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a87b5aad2d2f85e4af9046d7ea40913c8}{{\bfseries cour\-\_\-least}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a87b5aad2d2f85e4af9046d7ea40913c8}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a60a04e01f0bc1843a65eddcb7c388b6c}{{\bfseries i}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a60a04e01f0bc1843a65eddcb7c388b6c}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ad7980557f43390dbafa7a32c2eb5587f}{{\bfseries j}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ad7980557f43390dbafa7a32c2eb5587f}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a1ce8167e370399dae153ffac1a9506cd}{{\bfseries co}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a1ce8167e370399dae153ffac1a9506cd}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ad30d2f98a2d53cac3e07e7e0b3cedd39}{{\bfseries co\-\_\-pre}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ad30d2f98a2d53cac3e07e7e0b3cedd39}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_aca2e98eb52dc3dcd664209462b181ba1}{{\bfseries maxratio}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_aca2e98eb52dc3dcd664209462b181ba1}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a03e5161b202d6d9ecaa2ab6bc2f6364c}{{\bfseries max\-\_\-delta\-\_\-t}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a03e5161b202d6d9ecaa2ab6bc2f6364c}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}{{\bfseries max\-\_\-delta\-\_\-t\-\_\-mult}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}

\item 
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae5af3c6c7c3c4a048d92af266d8abeca}{{\bfseries orig\-\_\-dt}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae5af3c6c7c3c4a048d92af266d8abeca}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Contains variables and methods needed for time step size handling. 



Definition at line 16 of file courant.\-py.



\subsection{Member Function Documentation}
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_a6a20926e1f36e2169eccdc27d92d787d}{\index{smoderp2d\-::src\-::courant\-::\-Courant@{smoderp2d\-::src\-::courant\-::\-Courant}!courant@{courant}}
\index{courant@{courant}!smoderp2d::src::courant::Courant@{smoderp2d\-::src\-::courant\-::\-Courant}}
\subsubsection[{courant}]{\setlength{\rightskip}{0pt plus 5cm}def smoderp2d.\-src.\-courant.\-Courant.\-courant (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{rainfall, }
\item[{}]{delta\-\_\-t, }
\item[{}]{efect\-\_\-vrst, }
\item[{}]{ratio}
\end{DoxyParamCaption}
)}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_a6a20926e1f36e2169eccdc27d92d787d}


Returns the adjusted/unchanged time step after a time step computation is completed. 

Also returns the ratio for the rill computation division. if ((ratio $>$ self.\-maxratio) or (self.\-cour\-\_\-most\-\_\-rill $>$ 1.\-0)) \-: ratio = self.\-maxratio ratio = 1 self.\-max\-\_\-delta\-\_\-t\-\_\-mult $\ast$= 0.\-9 

Definition at line 115 of file courant.\-py.


\begin{DoxyCode}
115 
116   \textcolor{keyword}{def }\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a6a20926e1f36e2169eccdc27d92d787d}{courant}(self,rainfall,delta\_t,efect\_vrst,ratio):
117 
118 
119     \textcolor{comment}{# ratio se muze zmensit  a max\_delta\_t\_mult zvetsit}
120     \textcolor{comment}{# pokud je courant v ryhach <= 0.2}
121     \textcolor{comment}{#}
122     \textcolor{comment}{# pokud je courant > 0.5 deje se opak}
123     \textcolor{comment}{# to je ale reseno lokalne}
124     \textcolor{comment}{# v  ./src/processes/rill.py}
125     \textcolor{comment}{#}
126     \textcolor{comment}{#if (self.cour\_most\_rill < 0.1) :}
127       \textcolor{comment}{#ratio = max(1,ratio-1) # ratio nemuze byt mensi nez 1}
128       \textcolor{comment}{#if ratio == 1 :}
129         \textcolor{comment}{#self.max\_delta\_t\_mult = 1.0}
130       \textcolor{comment}{#else :}
131         \textcolor{comment}{#self.max\_delta\_t\_mult = min(1.0, self.max\_delta\_t\_mult*1/(0.9)) # max\_delta\_t\_mult nemuze byt
       vetsi nez 1.0}
132 
133 
134 
135     \textcolor{comment}{# ratio se drzi na 10}
136     \textcolor{comment}{# vyse nelze jit}
137     \textcolor{comment}{# proto se zmensuje max\_delta\_t\_mult}
138     \textcolor{comment}{# ktery nasobi vysledne delta}
139     \textcolor{comment}{##}
140     \textcolor{comment}{#if ((ratio > self.maxratio) or (self.cour\_most\_rill > 1.0)) :}
141       \textcolor{comment}{#ratio = self.maxratio}
142       \textcolor{comment}{##ratio = 1}
143       \textcolor{comment}{#self.max\_delta\_t\_mult *= 0.9}
144 
145 
146     \textcolor{comment}{# pokud je maximalni courant mimo dovolena kryteria}
147     \textcolor{comment}{# mensi nez cour\_least a vetsi nez cour\_crit}
148     \textcolor{comment}{# explicitne se dopocita dt na nejvetsi mozne}
149     \textcolor{comment}{#                                      xor}
150     \textcolor{keywordflow}{if} ((self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_afa3e7bde711d11925d54a41ecffdc2f3}{cour\_most} < self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a87b5aad2d2f85e4af9046d7ea40913c8}{cour\_least}) !=  (self.
      \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a059271cdbd6044635ad290eadff9299b}{cour\_crit} <= self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_afa3e7bde711d11925d54a41ecffdc2f3}{cour\_most})):
151 
152       \textcolor{comment}{# pokud se na povrchu nic nedeje}
153       \textcolor{comment}{# nema se zmena dt cim ridit}
154       \textcolor{comment}{# a zmeni se podle maxima nasobeneho max\_delta\_t\_mult}
155       \textcolor{comment}{# max\_delta\_t\_mult se meni podle ryh, vyse v teto funkci}
156       \textcolor{comment}{#}
157       \textcolor{keywordflow}{if} (self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2e4c6d74b15eb45d67ebba896b97eb32}{cour\_speed}==0.0):
158         \textcolor{keywordflow}{return} self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a03e5161b202d6d9ecaa2ab6bc2f6364c}{max\_delta\_t}*self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}{max\_delta\_t\_mult}, ratio
159 
160       dt = round((efect\_vrst*self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a059271cdbd6044635ad290eadff9299b}{cour\_crit}*self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_ae0eb94299899733aa39b68e166115809}{cour\_coef})/self.
      \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2e4c6d74b15eb45d67ebba896b97eb32}{cour\_speed},4)
161 
162 
163       \textcolor{comment}{# nove dt nesmi byt vetsi nez je maxdt * max\_delta\_t\_mult}
164       \textcolor{comment}{# max\_delta\_t\_mult se meni podle ryh, vyse v teto funkci}
165       
166       \textcolor{comment}{#return dt*self.max\_delta\_t\_mult, ratio}
167       \textcolor{comment}{#return min(dt,self.max\_delta\_t*self.max\_delta\_t\_mult), ratio}
168       \textcolor{comment}{#print 'asdf', self.cour\_speed, dt, self.max\_delta\_t\_mult}
169       \textcolor{keywordflow}{return} min(dt*self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}{max\_delta\_t\_mult},self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a03e5161b202d6d9ecaa2ab6bc2f6364c}{max\_delta\_t}*self.
      \hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}{max\_delta\_t\_mult}), ratio
170 
171     \textcolor{comment}{# pokud je courant v povolenem rozmezi}
172     \textcolor{comment}{# skontrolje se pouze pokud neni vetsi nez maxdt * max\_delta\_t\_mult}
173     \textcolor{comment}{# max\_delta\_t\_mult se meni podle ryh, vyse v teto funkci}
174     \textcolor{keywordflow}{else}:
175       \textcolor{comment}{#print 'fdafdsfasdfadsfadsfadsfaf'}
176       \textcolor{comment}{#return delta\_t, ratio}
177       \textcolor{comment}{#print 'asdf', dt, dt*self.max\_delta\_t\_mult, ratio}
178       \textcolor{keywordflow}{if} ((ratio <= self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_aca2e98eb52dc3dcd664209462b181ba1}{maxratio}) \textcolor{keywordflow}{and} (self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a2bfcce1ddcb5060045dbd777c848c9f2}{cour\_most\_rill} < 0.5)) :
179         \textcolor{keywordflow}{return} delta\_t, ratio
180       \textcolor{keywordflow}{else}:
181         \textcolor{keywordflow}{return} delta\_t*self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a4cd64dfec3bd294d881fd28581250b45}{max\_delta\_t\_mult}, ratio
182 
183 
184     prt.error(\textcolor{stringliteral}{'courant.cour() missed all its time step conditions\(\backslash\)n no rule to preserve or change the time
       step!'})
185 
\end{DoxyCode}
\hypertarget{classsmoderp2d_1_1src_1_1courant_1_1Courant_ab69d95fbe66467f71b0a535be611f05b}{\index{smoderp2d\-::src\-::courant\-::\-Courant@{smoderp2d\-::src\-::courant\-::\-Courant}!initial\-\_\-time\-\_\-step@{initial\-\_\-time\-\_\-step}}
\index{initial\-\_\-time\-\_\-step@{initial\-\_\-time\-\_\-step}!smoderp2d::src::courant::Courant@{smoderp2d\-::src\-::courant\-::\-Courant}}
\subsubsection[{initial\-\_\-time\-\_\-step}]{\setlength{\rightskip}{0pt plus 5cm}def smoderp2d.\-src.\-courant.\-Courant.\-initial\-\_\-time\-\_\-step (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{sur}
\end{DoxyParamCaption}
)}}\label{classsmoderp2d_1_1src_1_1courant_1_1Courant_ab69d95fbe66467f71b0a535be611f05b}


Guesses the initial time step. 

the guess is based on the maximum {\itshape a} and {\itshape b} parameters of the kinematic wave equation and critical water level in case of sheet flow only calculation the water level guess is 0.\-001 {\itshape m} by default 

Definition at line 61 of file courant.\-py.


\begin{DoxyCode}
61 
62   \textcolor{keyword}{def }\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_ab69d95fbe66467f71b0a535be611f05b}{initial\_time\_step}(self,sur):
63     \textcolor{comment}{#sumA = sumB = sumHCrit = 0}
64     \textcolor{comment}{#count = 0}
65     \textcolor{comment}{#only\_surface = comp\_type('surface')}
66 
67 
68 
69 
70     \textcolor{comment}{#for i in sur.rr:}
71       \textcolor{comment}{#for j in sur.rc[i]:}
72         \textcolor{comment}{#sumA += sur.arr[i][j].a}
73         \textcolor{comment}{#sumB += sur.arr[i][j].b}
74         \textcolor{comment}{#sumHCrit += sur.arr[i][j].h\_crit}
75         \textcolor{comment}{#count += 1}
76 
77     \textcolor{comment}{#meanA = sumA/float(count)}
78     \textcolor{comment}{#meanB = sumB/float(count)}
79     \textcolor{comment}{#if (only\_surface) :}
80       \textcolor{comment}{#meanHCrit = 0.001}
81     \textcolor{comment}{#else:}
82       \textcolor{comment}{#meanHCrit = sumHCrit/float(count)}
83 
84 
85 
86     \textcolor{comment}{#velGuess = meanA*meanHCrit*meanB*meanB}
87     \textcolor{comment}{#self.initGuess = (math.sqrt(sur.pixel\_area)*self.cour\_least*self.cour\_coef)/velGuess}
88 
89     \textcolor{comment}{#return self.initGuess}
90     \textcolor{keywordflow}{return} self.\hyperlink{classsmoderp2d_1_1src_1_1courant_1_1Courant_a03e5161b202d6d9ecaa2ab6bc2f6364c}{max\_delta\_t}
91 
92 

\end{DoxyCode}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
smoderp2d/src/courant.\-py\end{DoxyCompactItemize}
